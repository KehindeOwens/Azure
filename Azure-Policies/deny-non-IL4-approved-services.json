{
  "mode": "All",
  "policyRule": {
    "if": {
      "not": {
        "field": "type",
        "in": [
          "Microsoft.ApiManagement/service",
          "Microsoft.Automation/automationAccounts",
          "Microsoft.AAD/domainServices",
          "Microsoft.AzureActiveDirectory/",
          "Microsoft.Batch/batchAccounts",
          "Microsoft.Advisor/",
          "Microsoft.AnalysisServices/servers",
          "Microsoft.Blueprint/blueprints",
          "Microsoft.Blueprint/blueprintAssignments",
          "Microsoft.BotService/botServices",
          "Microsoft.BotService/enterpriseChannels",
          "Microsoft.Cache/Redis",
          "Microsoft.ClassicCompute/domainNames",
          "Microsoft.CloudService/",
          "Microsoft.Compute/availabilitySets",
          "Microsoft.Compute/disks",
          "Microsoft.Compute/virtualMachines",
          "Microsoft.Compute/virtualMachines/extensions",
          "Microsoft.Compute/virtualMachineScaleSets",
          "Microsoft.ContainerRegistry/registries",
          "Microsoft.ContainerInstance/containerGroups",
          "Microsoft.ContainerService/",
          "Microsoft.ContainerService/managedClusters",
          "Microsoft.CostManagement/",
          "Microsoft.CostManagementExports/",
          "Microsoft.CognitiveServices/accounts",
          "Microsoft.DataBoxEdge/",
          "Microsoft.DataFactory/factories",
          "Microsoft.DataExplorer/",
          "Microsoft.DataLakeStore/",
          "Microsoft.DataMigration/services",
          "Microsoft.DataLakeStore/accounts",
          "Microsoft.DBforMariaDB/servers",
          "Microsoft.DBforMySQL/servers",
          "Microsoft.DBforPostgreSQL/servers",
          "Microsoft.Devices/",
          "Microsoft.DevTestLab/labs",
          "Microsoft.DevTestLab/schedules",
          "Microsoft.DocumentDB/databaseAccounts",
          "Microsoft.EventHub/namespaces",
          "Microsoft.EventGrid/domains",
          "Microsoft.EventGrid/topics",
          "Microsoft.HardwareSecurityModules/dedicatedhsms",
          "Microsoft.HDInsight/clusters",
          "Microsoft.InformationProtection/",
          "Microsoft.Insights/",
          "Microsoft.Intune/",
          "Microsoft.ImportExport/jobs",
          "Microsoft.KeyVault/vaults",
          "Microsoft.Kubernetes/",
          "Microsoft.KubernetesConfiguration/",
          "Microsoft.LabServices/labaccounts",
          "Microsoft.Logic/integrationAccounts",
          "Microsoft.Logic/workflows",
          "Microsoft.ManagedServices",
          "Microsoft.Maps/accounts",
          "Microsoft.Media/mediaservices",
          "Microsoft.Migrate/operations",
          "Microsoft.Migrate/projects",
          "Microsoft.Network/applicationGateways",
          "Microsoft.Network/ApplicationGatewayWebApplicationFirewallPolicies",
          "Microsoft.Network/azureFirewalls",
          "Microsoft.Network/dnsOperationResults",
          "Microsoft.Network/dnsOperationStatuses",
          "Microsoft.Network/dnszones",
          "Microsoft.Network/expressRouteCircuits",
          "Microsoft.Network/expressRouteCrossConnections",
          "Microsoft.Network/expressRouteGateways",
          "Microsoft.Network/ExpressRoutePorts",
          "Microsoft.Network/frontDoors",
          "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
          "Microsoft.Network/loadBalancers",
          "Microsoft.Network/NetworkExperimentProfiles",
          "Microsoft.Network/networkInterfaces",
          "Microsoft.Network/networkSecurityGroups",
          "Microsoft.Network/networkWatchers",
          "Microsoft.Network/privateDnsOperationResults",
          "Microsoft.Network/privateOperationStatuses",
          "Microsoft.Network/privateDnsZones",
          "Microsoft.Network/publicIPAddresses",
          "Microsoft.Network/routeTables",
          "Microsoft.Network/trafficmanagerprofiles",
          "Microsoft.Network/virtualNetworks",
          "Microsoft.Network/vpnGateways",
          "Microsoft.NotificationHubs",
          "Microsoft.OperationsManagement/ManagementAssociations",
          "Microsoft.OperationsManagement/solutions",
          "Microsoft.Portal/dashboards",
          "Microsoft.PowerBIDedicated/",
          "Microsoft.Resources/deployments",
          "Microsoft.Resources/deploymentScripts",
          "Microsoft.Resources/resourceGroups",
          "Microsoft.Resources/tags",
          "Microsoft.ResourceGraph/",
          "Microsoft.RecoveryServices/",
          "Microsoft.RecoveryServices/vaults",
          "Microsoft.RecoveryServices/locations",
          "Microsoft.Security/",
          "Microsoft.ServiceBus/namespaces",
          "Microsoft.ServiceFabric/clusters",
          "Microsoft.Scheduler/jobCollections",
          "Microsoft.Solutions/",
          "Microsoft.Sql/servers/databases",
          "Microsoft.StreamAnalytics/streamingJobs",
          "Microsoft.Storage/storageAccounts",
          "Microsoft.StorSimple/managers",
          "Microsoft.Synapse/",
          "Microsoft.Web/serverfarms",
          "Microsoft.Web/sites"
        ]
      }
    },
    "then": {
      "effect": "deny"
    }
  },
  "parameters": {}
}
